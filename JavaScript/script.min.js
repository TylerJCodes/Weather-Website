function getParameterByName(e,a){a||(a=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),o=t.exec(a);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null}function getSavedLocations(){$.getJSON("https://maps.googleapis.com/maps/api/geocode/json?place_id="+savedLocations[querySaved]+"&key="+googleAPIKeyOf,function(e){locationResponse=e,savedDisplay=!0;var a=locationResponse.results[0].geometry.location.lat,t=locationResponse.results[0].geometry.location.lng;coordsOf=a+","+t,runWeatherCall(),$("#saved-location-"+querySaved).html(locationResponse.results[0].formatted_address)})}var tempUnit="Imperial",DataOf,locationGeoCoding,tempOf,weatherID,weatherTypeOf="weather",tempOfType,daysOfTheWeek=[],coordsOf,gtTypeForcast="Hourly",revGeoCoding,locationQuery,locationOf,getLocationsOf=JSON.parse(localStorage.getItem("saved-locations")),placeID,savedDisplay=!1,currentPlaceID,checkedTF=!1;if(null==getLocationsOf)var savedLocations=[];else var savedLocations=getLocationsOf;var locationOf,googleAPIKeyOf="AIzaSyCucEeFMlKcf4vbng0Wn9PQkoRzlcoPocs",darkskyAPIKeyOf="2258602bc314382e0dd633305e57fff4",loadingIcon=function(){var e=new Skycons({color:"white"});e.set("wind-loading",Skycons.WIND),e.play()};loadingIcon();var queryStringOf=getParameterByName("location"),getLocationQuery=function(){$.getJSON("https://maps.googleapis.com/maps/api/geocode/json?address="+locationQuery+"&key="+googleAPIKeyOf,function(e){locationGeoCoding=e;var a=locationGeoCoding.results[0].address_components.length,t=locationGeoCoding.results[0].address_components[a-1].long_name;getBG(t);var o=locationGeoCoding.results[0].geometry.location.lat,n=locationGeoCoding.results[0].geometry.location.lng;placeID=locationGeoCoding.results[0].place_id,coordsOf=o+","+n,locationOf=locationGeoCoding.results[0].formatted_address,runWeatherCall()})};null!=queryStringOf&&(locationQuery=queryStringOf,getLocationQuery());var runWeatherCall=function(){$.getJSON("https://api.darksky.net/forecast/"+darkskyAPIKeyOf+"/"+coordsOf+"?lang=en&callback=?",function(e){DataOf=e,1!=savedDisplay?weatherAPI():savedDisplay===!0&&querySaved<savedLocations.length&&(tempOfCurrent=Math.floor(DataOf.currently.temperature),$("#saved-location-temp-"+querySaved).html(tempOfCurrent),$("#saved-location-canvas-"+querySaved).attr("class",DataOf.currently.icon),$("#saved-location-sum-"+querySaved).html(DataOf.currently.summary),$("#saved-wind-temp-"+querySaved).html(DataOf.currently.windSpeed+" mph"),querySaved++,runSkyCons(),getSavedLocations())})},weatherAPI=function(){tempOfCurrent=Math.floor(DataOf.currently.temperature);var e=DataOf.currently.summary,a=(DataOf.hourly.summary,0);$("canvas:eq(0)").attr("class",DataOf.currently.icon),$(".temp-of-0").html(tempOfCurrent+"<small>&#176; F</small>"),$("#weather-of-0").html(e),$(".wind-speed").html(DataOf.currently.windSpeed+" mph"),getTime();for(var t=0;t<DataOf.daily.data.length;t++){tempOfMax=Math.floor(DataOf.daily.data[t].temperatureMax),tempOfMin=Math.floor(DataOf.daily.data[t].temperatureMin);var o=DataOf.daily.data[t].summary;$(".temp-display").eq(a).find("canvas").attr("class",DataOf.daily.data[t].icon),$(".temp-of-"+(a+1)).html(tempOfMax+"<small>&#176;</small>"),$("#low-temp-"+t).html(tempOfMin),$("#weather-of-"+t).html(o),$("#sum-box-"+t).attr("class",DataOf.daily.data[t].icon);var n=new Date(1e3*DataOf.daily.data[t].time),s=n.getDay();$(".day-of-"+t).html(daysOfTheWeek[s]),a++}void 0==revGeoCoding&&getLocationDets(),$("#loading-con").css("display","none"),runSkyCons()};$("#celsius-of").click(function(){if("Metric"!=tempUnit){tempUnit="Metric",tempOfType=$(".temp-of-0").html().match(/\d+/)[0];var e=5*(tempOfType-32)/9,a=Math.round(10*e)/10;$(".temp-of-0").html(a+"<small>&#176; C</small>");for(var t=1;t<=$(".temp-of-max").length;t++){tempOfType=$(".temp-of-"+t).html().match(/\d+/)[0];var e=5*(tempOfType-32)/9,a=Math.round(10*e)/10;$(".temp-of-"+t).html(a+"<small>&#176;</small>")}for(var o=0;o<$(".temp-of-low").length;o++)tempOfType=$("#low-temp-"+o).html().match(/\d+/)[0],e=5*(tempOfType-32)/9,a=Math.round(10*e)/10,$("#low-temp-"+o).html(a+"<small>&#176;</small>")}}),$("#fahrenheit-of").click(function(){if("Imperial"!=tempUnit){tempUnit="Imperial",tempOfType=$(".temp-of-0").html().match(/\d+/)[0],tempOf=Math.round(1.8*tempOfType+32),$(".temp-of-0").html(tempOf+"<small>&#176; F</small>");for(var e=1;e<=$(".temp-of-max").length;e++)tempOfType=$(".temp-of-"+e).html().match(/\d+/)[0],tempOf=Math.round(1.8*tempOfType+32),$(".temp-of-"+e).html(tempOf+"<small>&#176;</small>");for(var a=0;a<$(".temp-of-low").length;a++)tempOfType=$("#low-temp-"+a).html().match(/\d+/)[0],tempOf=Math.round(1.8*tempOfType+32),$("#low-temp-"+a).html(tempOf+"<small>&#176;</small>")}});var getTime=function(){var e=new Date,a=moment.tz(DataOf.timezone).toString(),t=a.substring(15,a.length);e.getDate();daysOfTheWeek=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],$("#timezone-of").html("<small>( "+t+" )</small>"),$("#todays-date").html(a.substring(0,15)).hover(function(){$("#timezone-of").css("display","inline-block")},function(){$("#timezone-of").css("display","none")});var o=function(){var a=(e.getHours(),e.getMinutes(),1e3*DataOf.currently.time),t=moment.tz(a,DataOf.timezone).format("h:mm a");$(".time-of").html(t)};o()};$("#see-hourly-btn").click(function(){var e,a=1;if(tempUnit="Imperial","Hourly"==gtTypeForcast){gtTypeForcast="Daily",$(".temp-of-low").css("display","none");var t=function(){e=s};$("canvas:eq(0)").attr("class",DataOf.hourly.data[0].icon),$(".temp-of-0").html(Math.floor(DataOf.hourly.data[0].temperature)+"<small>&#176; F</small>"),$("#weather-of-0").html(DataOf.hourly.data[0].summary),$(".wind-speed").html(DataOf.hourly.data[0].windSpeed+" mph");for(var o=0;8>o;o++){var n=1e3*DataOf.hourly.data[o].time,s=moment.tz(n,DataOf.timezone).format("h:mm a").toString();t(),tempOfHourly=Math.floor(DataOf.hourly.data[o].temperature);var l=DataOf.hourly.data[o].summary;$("canvas:eq("+a+")").attr("class",DataOf.hourly.data[o].icon),$(".temp-of-"+o).html(tempOfHourly+"<small>&#176;</small>"),$("#weather-of-"+o).html(l);var c=new Date(1e3*DataOf.daily.data[o].time);c.getDay();$(".day-of-"+o).html(e),a++}$("#see-hourly-btn").html("See daily"),runSkyCons()}else"Daily"==gtTypeForcast&&(gtTypeForcast="Hourly",weatherAPI(),$(".temp-of-low").css("display","inline-block"),$("#see-hourly-btn").html("See Hourly"))});var getLocationDets=function(){$.getJSON("https://maps.googleapis.com/maps/api/geocode/json?latlng="+coordsOf+"&key="+googleAPIKeyOf,function(e){for(revGeoCoding=e,$("#add-city-button").css("display","inline-block"),$(".location-of").html(locationOf),x=0;x<savedLocations.length;x++)for(i=0;i<revGeoCoding.results.length;i++)(savedLocations[x]==revGeoCoding.results[i].place_id||savedLocations[x]==locationGeoCoding.results[0].place_id)&&(currentPlaceID=locationGeoCoding.results[0].place_id,checkedTF=!0,$("#add-location").removeClass("fa-plus-square").addClass("fa-check").css("color","#2e7d32"),$("#add-city-button").prop("disabled",!0))})},runSkyCons=function(){var a,t=new Skycons({color:"wheat"}),o=["clear-day","clear-night","partly-cloudy-day","partly-cloudy-night","cloudy","rain","sleet","snow","wind","fog"];for(a=o.length;a--;){var n=o[a],s=document.getElementsByClassName(n);for(e=s.length;e--;)t.set(s[e],n)}t.play()};$("#add-city-button").unbind().click(function(){savedLocations.length<5?(savedLocations.push(placeID),$("#add-location").removeClass("fa-plus-square").addClass("fa-check").css("color","#2e7d32"),$("#add-city-button").prop("disabled",!0),checkedTF=!0,localStorage.setItem("saved-locations",JSON.stringify(savedLocations))):savedLocations.length>=5&&alert("To many saved locations")}),$("#saved-locations").unbind().click(function(){savedLocationsFunc(),$(".body-container").fadeOut("fast"),$(".ct4").fadeIn("slow"),$("#location-search").prependTo("#empty-col").css("float","none")});var savedLocationsFunc=function(){placeID=savedLocations,getLocationsOf=JSON.parse(localStorage.getItem("saved-locations")),getSavedLocations()},querySaved=0;$(".saved-box").click(function(){var e=$(this).find(".saved-location").text();""!=e&&(window.location.href="Main.html?location="+e)});var pageOf=1;$("#right-button").unbind().click(function(){$("#right-button").css("display","none"),$("#saved-locations").css("display","none"),$(".weather-cols").animate({left:"-85%"},2e3,function(){for(o=0;o<4;o++)$("#day-"+o).css("display","none");for($(".weather-cols").css("left","0"),pageOf++,$("#left-button").css("display","inline-block"),restODays=5;restODays<=8;restODays++)$("#day-"+restODays).fadeIn("slow");$("#saved-locations").fadeIn("slow")})}),$("#left-button").unbind().click(function(){$("#left-button").css("display","none"),$("#saved-locations").css("display","none"),$(".weather-cols").animate({left:"85%"},2e3,function(){for(o=8;o>4;o--)$("#day-"+o).css("display","none");for($(".weather-cols").css("left","0"),pageOf++,$("#right-button").css("display","inline-block"),restODays=0;restODays<=4;restODays++)$("#day-"+restODays).fadeIn("slow");$("#saved-locations").fadeIn("slow")})}),$(".button-con").mouseenter(function(){checkedTF===!0&&($("#add-location").css("display","none"),$("#remove-city-button").css("display","inline-block"))}).mouseleave(function(){checkedTF===!0&&($("#remove-city-button").css("display","none"),$("#add-location").css("display","inline-block"))}),$("#remove-city-button").click(function(){var e=savedLocations.indexOf(currentPlaceID);savedLocations.splice(e,1),localStorage.setItem("saved-locations",JSON.stringify(savedLocations)),checkedTF=!1,$("#remove-city-button").css("display","none"),$("#add-location").css("display","inline-block"),$("#add-location").removeClass("fa-check").addClass("fa-plus-square").css("color","white"),$("#add-city-button").prop("disabled",!1)}),$("#geo-location-btn").click(function(){"geolocation"in navigator?($("#loading-con").css("display","inline-block"),navigator.geolocation.getCurrentPosition(function(e){coordsOf=e.coords.latitude+","+e.coords.longitude,window.location.href="Main.html?location="+coordsOf},function(e){e.code==e.PERMISSION_DENIED&&$("#loading-con").css("display","none")})):($(this).text("Sorry, geolocation isn't supported in your browser!"),$(this).prop("disabled",!0),$(this).css("background-color","#D32F2F"))});var getBG=function(e){var a;switch(e){case"United States":a="1147412";break;case"Japan":a="1147421";break;case"China":a="1147428";break;case"Russia":a="1147437";break;case"Germany":a="1147445";break;case"Spain":a="1147453";break;case"Mexico":a="1147457";break;case"Turkey":a="1147464";break;case"France":a="1147508";break;case"Italy":a="1147514";break;case"South Africa":a="1147521";break;default:a="779288"}$("body").css("background-image",'url("https://source.unsplash.com/collection/'+a+'/1600x900")')};